<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>–ë–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–æ —Ñ–∏–∑–ª–∏—Ü –≤ –ò—Ä–∫—É—Ç—Å–∫–µ ‚Äî –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –∫–æ–º–ø–∞–Ω–∏—è ¬´–ï—Å—Ç—å —Ä–µ—à–µ–Ω–∏–µ¬ª</title>
  <meta name="description" content="–°–ø–∏—Å–∞–Ω–∏–µ –¥–æ–ª–≥–æ–≤ —á–µ—Ä–µ–∑ –±–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–æ —Ñ–∏–∑–ª–∏—Ü ‚Äî –±–µ—Å–ø–ª–∞—Ç–Ω–æ –ø–æ–¥ –∫–ª—é—á. –†–∞–±–æ—Ç–∞–µ–º —á–µ—Ä–µ–∑ –ú–§–¶ –∏ —Å—É–¥. –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è —é—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –∫–æ–º–ø–∞–Ω–∏—è ¬´–ï—Å—Ç—å —Ä–µ—à–µ–Ω–∏–µ¬ª.">
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #f6f8fa;
      color: #222;
    }
    header {
      background: #17468c;
      color: white;
      padding: 20px;
      text-align: center;
    }
    .container {
      padding: 20px;
      max-width: 1100px;
      margin: auto;
    }
    h1, h2 {
      color: #17468c;
    }
    .hero {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      gap: 20px;
    }
    .hero-text {
      flex: 1;
    }
    .hero-img {
      flex: 1;
      max-width: 300px;
    }
    .hero-img img {
      width: 100%;
      height: auto;
      border-radius: 10px;
      display: block;
      margin: auto;
    }
    .section {
      margin-top: 40px;
    }
    .image-placeholder {
      width: 100%;
      height: 200px;
      background: #ddd;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #999;
      font-size: 16px;
      margin: 20px 0;
    }
    footer {
      background: #222;
      color: white;
      padding: 20px;
      text-align: center;
    }
    .contacts {
      margin-top: 20px;
    }
    .vk-icon {
      width: 24px;
      vertical-align: middle;
      margin-right: 5px;
    }
    #mic-btn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 9999;
      font-size: 28px;
      padding: 15px;
      border: none;
      border-radius: 50%;
      background-color: #17468c;
      color: white;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    }
    @media (max-width: 768px) {
      .hero {
        flex-direction: column;
      }
      .hero-img {
        max-width: 200px;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –∫–æ–º–ø–∞–Ω–∏—è ¬´–ï—Å—Ç—å —Ä–µ—à–µ–Ω–∏–µ¬ª</h1>
    <p>–ü–æ–º–æ–≥–∞–µ–º —Å–ø–∏—Å–∞—Ç—å –¥–æ–ª–≥–∏ —á–µ—Ä–µ–∑ –±–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–æ –≤ –ò—Ä–∫—É—Ç—Å–∫–µ –∏ –ø–æ –≤—Å–µ–π –†–æ—Å—Å–∏–∏</p>
  </header>

  <div class="container">
    <div class="hero">
      <div class="hero-text">
        <h2>–ë–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–æ —Ñ–∏–∑–ª–∏—Ü –ø–æ–¥ –∫–ª—é—á</h2>
        <p>–ï—Å–ª–∏ —É –≤–∞—Å –Ω–∞–∫–æ–ø–∏–ª–∏—Å—å –¥–æ–ª–≥–∏, –∏ –≤—ã –Ω–µ —Å–ø—Ä–∞–≤–ª—è–µ—Ç–µ—Å—å ‚Äî –º—ã –ø–æ–º–æ–∂–µ–º —Å–ø–∏—Å–∞—Ç—å –∏—Ö –ø–æ–ª–Ω–æ—Å—Ç—å—é —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –ø—Ä–æ—Ü–µ–¥—É—Ä—É –±–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–∞. –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è, –ø–æ–¥–∞—á–∞ —á–µ—Ä–µ–∑ –ú–§–¶ –∏–ª–∏ —Å—É–¥.</p>
      </div>
      <div class="hero-img">
        <img src="https://i.imgur.com/57vEn4P.png" alt="–Æ—Ä–∏—Å—Ç –ê–Ω–Ω–∞" loading="lazy">
      </div>
    </div>

    <div class="section">
      <h2>–ß—Ç–æ —Ç–∞–∫–æ–µ –±–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–æ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –ª–∏—Ü?</h2>
      <p>–≠—Ç–æ –∑–∞–∫–æ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± —Å–ø–∏—Å–∞—Ç—å –≤—Å–µ –¥–æ–ª–≥–∏ —á–µ—Ä–µ–∑ —Å—É–¥ –∏–ª–∏ –ú–§–¶. –ü–æ–¥—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å –ø—Ä–µ–≤—ã—à–∞–µ—Ç 100 000 ‚ÇΩ, –∏ –≤—ã –Ω–µ –º–æ–∂–µ—Ç–µ –ø–ª–∞—Ç–∏—Ç—å.</p>
      <div class="image-placeholder">–ö–∞—Ä—Ç–∏–Ω–∫–∞ –ø—Ä–æ –¥–æ–ª–≥–∏</div>
    </div>

    <div class="section">
      <h2>–ë–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–æ —á–µ—Ä–µ–∑ –ú–§–¶</h2>
      <p>–ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –±–µ–∑ —Å—É–¥–∞. –ü–æ–¥—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ —É –≤–∞—Å –Ω–µ—Ç –∏–º—É—â–µ—Å—Ç–≤–∞, –¥–æ—Ö–æ–¥–æ–≤ –∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤. –ú—ã –ø–æ–º–æ–∂–µ–º —Å–æ–±—Ä–∞—Ç—å –≤—Å–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏ –ø–æ–¥–∞—Ç—å –∑–∞—è–≤–ª–µ–Ω–∏–µ.</p>
      <div class="image-placeholder">–ö–∞—Ä—Ç–∏–Ω–∫–∞ –ø—Ä–æ –ú–§–¶</div>
    </div>

    <div class="section">
      <h2>–°—É–¥–µ–±–Ω–æ–µ –±–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–æ</h2>
      <p>–ü–æ–¥—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –µ—Å—Ç—å –∑–∞—Ä–ø–ª–∞—Ç–∞, –∏–º—É—â–µ—Å—Ç–≤–æ –∏–ª–∏ –∫—Ä–µ–¥–∏—Ç—ã —Å –∑–∞–ª–æ–≥–æ–º. –ú—ã –ø–æ–¥–∞—ë–º –∑–∞—è–≤–ª–µ–Ω–∏–µ –≤ –∞—Ä–±–∏—Ç—Ä–∞–∂–Ω—ã–π —Å—É–¥, —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞–µ–º –Ω–∞ –≤—Å–µ—Ö —ç—Ç–∞–ø–∞—Ö.</p>
      <div class="image-placeholder">–ö–∞—Ä—Ç–∏–Ω–∫–∞ –ø—Ä–æ —Å—É–¥</div>
    </div>

    <div class="section">
      <h2>–≠—Ç–∞–ø—ã –±–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–∞</h2>
      <ol>
        <li>–ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è</li>
        <li>–°–±–æ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</li>
        <li>–ü–æ–¥–∞—á–∞ –∑–∞—è–≤–ª–µ–Ω–∏—è</li>
        <li>–°–ø–∏—Å–∞–Ω–∏–µ –¥–æ–ª–≥–æ–≤</li>
      </ol>
    </div>

    <div class="section">
      <h2>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h2>
      <p>–ê–¥—Ä–µ—Å: 664007, –≥. –ò—Ä–∫—É—Ç—Å–∫, —É–ª. –ü–æ–ª–µ–Ω–æ–≤–∞ 1/1, –æ—Ñ–∏—Å 213</p>
      <p>–¢–µ–ª–µ—Ñ–æ–Ω: 8 800 600 38 23</p>
      <p>
        <img class="vk-icon" src="https://upload.wikimedia.org/wikipedia/commons/2/21/VK.com-logo.svg" alt="–í–ö–æ–Ω—Ç–∞–∫—Ç–µ">
        <a href="https://vk.com/bankrot_irk" style="color: #17468c; text-decoration: none;">–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ –í–ö</a>
      </p>
    </div>
  </div>

  <footer>
    ¬© 2025 –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –∫–æ–º–ø–∞–Ω–∏—è ¬´–ï—Å—Ç—å —Ä–µ—à–µ–Ω–∏–µ¬ª
  </footer>

  <button id="mic-btn">üé§</button>
  <audio id="audio-player" autoplay></audio>

  <script>
    const OPENAI_PROXY_URL = "https://openai-gpt-proxy.onrender.com/gpt";
    const STREAM_URL = "https://elevenlabs-render-proxy.onrender.com/stream";

    let messages = [];
    let isRunning = false;
    let greeted = false;

    async function recognizeSpeech(timeout = 10000) {
      return new Promise((resolve, reject) => {
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        if (!SpeechRecognition) return reject("SpeechRecognition –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è");

        const recognition = new SpeechRecognition();
        recognition.lang = "ru-RU";
        recognition.interimResults = false;

        const timer = setTimeout(() => {
          recognition.stop();
          reject("‚è±Ô∏è –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∏—Å—Ç–µ–∫–ª–æ");
        }, timeout);

        recognition.onstart = () => console.log("üéôÔ∏è –°–ª—É—à–∞—é...");
        recognition.onresult = (event) => {
          clearTimeout(timer);
          recognition.stop();
          const text = event.results[0][0].transcript;
          resolve(text);
        };
        recognition.onerror = (err) => {
          clearTimeout(timer);
          recognition.stop();
          reject(err.error || "–û—à–∏–±–∫–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è");
        };

        recognition.start();
      });
    }

    async function askGPT() {
      const res = await fetch(OPENAI_PROXY_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ messages: messages.slice(-10) })
      });
      const data = await res.json();
      return data.choices?.[0]?.message?.content || "‚ùå GPT –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª";
    }

    async function playTTS(text) {
      const res = await fetch(STREAM_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ text })
      });

      if (!res.ok) return;
      const audioBlob = new Blob([await res.arrayBuffer()], { type: "audio/mpeg" });
      if (audioBlob.size < 1000) return;

      const audioUrl = URL.createObjectURL(audioBlob);
      const audio = document.getElementById("audio-player");
      audio.src = audioUrl;
      audio.load();

      try {
        await audio.play();
      } catch (err) {
        console.warn("üéß autoplay error:", err);
      }

      await new Promise(resolve => {
        audio.onended = resolve;
        audio.onerror = resolve;
      });
    }

    async function dialogLoop() {
      if (isRunning) return;
      isRunning = true;

      try {
        if (!greeted) {
          messages.push({ role: "user", content: "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–æ—à–µ–ª" });
          const greet = await askGPT();
          messages.push({ role: "assistant", content: greet });
          await playTTS(greet);
          greeted = true;
        }

        while (true) {
          const userText = await recognizeSpeech();
          messages.push({ role: "user", content: userText });

          const reply = await askGPT();
          messages.push({ role: "assistant", content: reply });

          await playTTS(reply);
        }
      } catch (err) {
        console.warn("üí• –û—à–∏–±–∫–∞:", err);
      } finally {
        isRunning = false;
      }
    }

    document.getElementById("mic-btn").onclick = () => {
      dialogLoop();
    };
  </script>
</body>
</html>
